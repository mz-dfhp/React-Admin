name: Build and Deploy
on: # ç›‘å¬ main åˆ†æ”¯ä¸Šçš„ push äº‹ä»¶
  push:
    branches:
      - main
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest # æ„å»ºç¯å¢ƒä½¿ç”¨ ubuntu
    steps:
      - name: Checkout # å°†ä»£ç æ‹‰åˆ°è™šæ‹Ÿæœº
        uses: actions/checkout@v2.3.1
        with:
          persist-credentials: false

      # - name: Install and Build # ä¸‹è½½ä¾èµ– æ‰“åŒ…é¡¹ç›®
      #   run: |
      #     npm i -g pnpm
      #     pnpm install --no-frozen-lockfile
      #     pnpm run build
      # - name: Deploy to remote ğŸš€ # éƒ¨ç½²åˆ°æœåŠ¡å™¨
      #   uses: appleboy/scp-action@master
      #   with:
      #     host: ${{ secrets.REMOTE_HOST }}
      #     username: ${{ secrets.REMOTE_USERNAME }}
      #     password: ${{ secrets.REMOTE_PASSWORD }}
      #     port: 22
      #     source: 'dist/'
      #     target: ${{ secrets.REMOTE_TARGET }}
      # - name: Checkout # å°†ä»£ç æ‹‰åˆ°è™šæ‹Ÿæœº
      #   uses: actions/checkout@v2.3.1
      #   with:
      #     persist-credentials: false

      - name: Install and Build # ä¸‹è½½ä¾èµ– æ‰“åŒ…é¡¹ç›®
        run: |
          npm i -g pnpm
          pnpm install --no-frozen-lockfile
          pnpm run build:github

      - name: Deploy to github-pagesğŸš€ # éƒ¨ç½²åˆ°github.io
        uses: JamesIves/github-pages-deploy-action@v4.3.3
        with:
          branch: static-pages # éƒ¨ç½²åæäº¤åˆ°çš„åˆ†æ”¯
          folder: dist # è¿™é‡Œå¡«æ‰“åŒ…å¥½çš„ç›®å½•åç§°
